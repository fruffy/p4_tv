--- before_pass
+++ after_pass
@@ -18,7 +18,7 @@ struct headers {
 }
 parser CommonParser(packet_in buffer, out headers parsed_hdr, inout metadata user_meta) {
     state start {
-        buffer.extract(parsed_hdr.ethernet);
+        buffer.extract<ethernet_t>(parsed_hdr.ethernet);
         transition accept;
     }
 }
@@ -46,7 +46,7 @@ control egress(inout headers hdr, inout
 }
 control CommonDeparserImpl(packet_out packet, inout headers hdr) {
     apply {
-        packet.emit(hdr.ethernet);
+        packet.emit<ethernet_t>(hdr.ethernet);
     }
 }
 control IngressDeparserImpl(packet_out buffer, out empty_t clone_i2e_meta, out empty_t resubmit_meta, out empty_t normal_meta, inout headers hdr, in metadata meta, in psa_ingress_output_metadata_t istd) {
@@ -61,6 +61,6 @@ control EgressDeparserImpl(packet_out bu
         cp.apply(buffer, hdr);
     }
 }
-IngressPipeline(IngressParserImpl(), ingress(), IngressDeparserImpl()) ip;
-EgressPipeline(EgressParserImpl(), egress(), EgressDeparserImpl()) ep;
-PSA_Switch(ip, PacketReplicationEngine(), ep, BufferingQueueingEngine()) main;
+IngressPipeline<headers, metadata, empty_t, empty_t, empty_t, empty_t>(IngressParserImpl(), ingress(), IngressDeparserImpl()) ip;
+EgressPipeline<headers, metadata, empty_t, empty_t, empty_t, empty_t>(EgressParserImpl(), egress(), EgressDeparserImpl()) ep;
+PSA_Switch<headers, metadata, headers, metadata, empty_t, empty_t, empty_t, empty_t, empty_t>(ip, PacketReplicationEngine(), ep, BufferingQueueingEngine()) main;
